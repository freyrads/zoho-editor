var XDC=function(){"use strict";var e={},n={},t=[],o="*",r="*",a=[],i=[],s={},c=/DocumentLoadInProgress|DocumentLoadComplete/g,d=function(e){return window===e},f={};f.setTarget=function(e){return!e||d(e.window)?this:(o=e.window||o,r=e.origin||r,this.setTrustedOrigins(),this)},f.setTrustedOrigins=function(e){if(a=e||a,r&&a.indexOf(r)===-1&&"*"!==r){var n=r.replace(/\[.]/g,".").replace(/\./g,"[.]");i.push(new RegExp("^"+n+"$"))}if(e)for(var t,o=0,s=a.length;o<s;o++)t=a[o].replace(/\[.]/g,".").replace(/\./g,"[.]"),i.push(new RegExp("^"+t+"$"))},f.addTargetChildById=function(e){t.push(e)};var u=function(e,n){e.length&&e.forEach(function(e){e.postMessage(n,r)})};f.postMessage=function(n){if(!o||!r)throw new TypeError("Target window or origin not configured!");var a=[];!d(window.parent)&&a.push(window.parent),"string"!=typeof o&&a.push(o),t.forEach(function(e){frames[e]&&a.push(frames[e].contentWindow)}),a.length&&("function"!=typeof n.oncomplete&&"function"!=typeof n.onexception||(e[n.id=p()]=[n],n=g(n),delete n.oncomplete,delete n.onexception),u(a,n))},f.receiveMessage=function(e){if(!o||!r)throw new TypeError("Target window or origin not configured!");var t=arguments[0];if("string"==typeof t){var a=arguments[1];if(!a)throw new TypeError("Handler not defined!");e={},e[t]=a;var i=arguments[2];i&&i.hasOwnProperty("async")&&(a.async=i.async)}for(var t in e){var c=n[t];s[t]&&e[t]?e[t]():c?c.push(e[t]):n[t]=[e[t]]}};var p=function(e){for(var n=e||12,t="",o="abcdefghijklmnopqrstuvwxyz0123456789",r=0;r<n;r++){var a=Math.floor(Math.random()*o.length);t+=o.substring(a,a+1)}return t},g=function(e){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e)){for(var n=[],t=0,o=e.length;t<o;t++)n[t]=g(e[t]);return n}var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=g(e[a]));return r},h=function(t){if(window.origin!==t.origin&&!l(t.origin))return void(!d(t.source)&&u([t.source],{id:t.data.id,exception:{code:1108,message:"Domain not registered",ref:"https://help.zoho.com/portal/en/kb/office-integrator/common/common-customization/articles/how-to-add-postmessage-domains"}}));if(!("*"!==o&&t.source!==o||"*"!==r&&t.origin!==r)){for(var a,i,f=t.data,p=f.message,h=n[p]||[],v=0,m=h.length;v<m;v++){i=g(f);try{a=h[v],a.async?!function(e,n){var o=new Promise(function(t,o){setTimeout(function(){e(t,o,n.data)},300)});o.then(function(e){n.data=e,u([t.source],n)})}(a,i):i.data=a(i.data)}catch(e){i.exception=e.stack}(!a.async&&void 0!==i.data&&null!==i.data||void 0!==i.exception&&null!==i.exception)&&(i.data.isAsyncResponse?i.data.asyncCallback&&i.data.asyncCallback(w.bind(null,t,i)):u([t.source],i))}for(c.test(p)&&(s[p]=!0),h=e[t.data.id]||[];a=h.shift();)t.data.hasOwnProperty("exception")?!!a.onexception&&a.onexception(t.data.exception):t.data.hasOwnProperty("data")&&!!a.oncomplete&&a.oncomplete(t.data.data);delete e[t.data.id]}},l=function(e){if(!e)return!1;for(var n=0;n<i.length;n++)if(i[n].test(e))return!0;return!1},w=function(e,n,t){n.data=t||{},u([e.source],n)};return window.addEventListener?addEventListener("message",h,!1):attachEvent("onmessage",h),f}();